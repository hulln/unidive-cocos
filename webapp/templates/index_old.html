<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Backchannel Candidates Viewer</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <h1>üéôÔ∏è Backchannel Candidates</h1>
            <div class="stats" id="stats">
                <div class="stat">
                    <span class="stat-label">Total</span>
                    <span class="stat-value" id="stat-total">-</span>
                </div>
                <div class="stat stat-high">
                    <span class="stat-label">HIGH</span>
                    <span class="stat-value" id="stat-high">-</span>
                </div>
                <div class="stat stat-medium">
                    <span class="stat-label">MEDIUM</span>
                    <span class="stat-value" id="stat-medium">-</span>
                </div>
                <div class="stat stat-low">
                    <span class="stat-label">LOW</span>
                    <span class="stat-value" id="stat-low">-</span>
                </div>
            </div>
        </header>

        <!-- Filters -->
        <div class="filters">
            <div class="filter-section">
                <h3 class="filter-section-title">üéØ Basic Filters</h3>
                <div class="filters-row">
                    <div class="filter-group">
                        <label title="Filter by confidence level (HIGH/MEDIUM/LOW)">Quality Level:</label>
                        <select id="filter-confidence">
                            <option value="">All levels</option>
                            <option value="HIGH">‚úÖ HIGH - Clean backchannels</option>
                            <option value="MEDIUM">‚ö†Ô∏è MEDIUM - Good with warnings</option>
                            <option value="LOW">‚ùå LOW - Needs review</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label title="Backchannels are typically 1-3 tokens (samostojno)">B Length (tokens):</label>
                        <input type="number" id="filter-min-tokens" placeholder="1" min="1" max="50" style="width: 60px;">
                        <span>to</span>
                        <input type="number" id="filter-max-tokens" placeholder="3" min="1" max="50" style="width: 60px;">
                        <span class="filter-hint">ideal: 1-3</span>
                    </div>

                    <div class="filter-group">
                        <label title="Numeric confidence score (0-100)">Confidence Score:</label>
                        <input type="number" id="filter-min-score" placeholder="0" min="0" max="100" style="width: 60px;">
                        <span>to</span>
                        <input type="number" id="filter-max-score" placeholder="100" min="0" max="100" style="width: 60px;">
                        <span class="filter-hint">0-100</span>
                    </div>
                </div>
            </div>

            <div class="filter-section">
                <h3 class="filter-section-title">üîÑ Continuation Pattern</h3>
                <div class="filters-row">
                    <div class="filter-group">
                        <label title="Does speaker A continue after B?">A continues:</label>
                        <select id="filter-continuation">
                            <option value="">Any pattern</option>
                            <option value="immediate">‚ö° Immediately (strongest evidence)</option>
                            <option value="windowed">‚è±Ô∏è Within 5 turns</option>
                            <option value="none">üõë No continuation (weakest)</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="filter-section">
                <h3 class="filter-section-title">üö© Warning Flags</h3>
                <div class="filters-row">
                    <div class="filter-group">
                        <select id="filter-has-content" title="B contains verbs, nouns, or adjectives (violates samostojno)">
                            <option value="">B has content words: Any</option>
                            <option value="0">‚úÖ No - simple marker</option>
                            <option value="1">‚ö†Ô∏è Yes - has VERB/NOUN/ADJ</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <select id="filter-is-question" title="B is a multi-token question">
                            <option value="">B is question: Any</option>
                            <option value="0">‚úÖ No</option>
                            <option value="1">‚ö†Ô∏è Yes - multi-token question</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <select id="filter-after-question" title="B comes after A's question (might be answer)">
                            <option value="">B after question: Any</option>
                            <option value="0">‚úÖ No</option>
                            <option value="1">‚ö†Ô∏è Yes - might be answer</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <select id="filter-a-backchannel" title="A looks like backchannel (wrong direction?)">
                            <option value="">A is backchannel: Any</option>
                            <option value="0">‚úÖ No</option>
                            <option value="1">‚ö†Ô∏è Yes - possible wrong direction</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="filter-section">
                <h3 class="filter-section-title">üîç Search & Document</h3>
                <div class="filters-row">
                    <div class="filter-group">
                        <label>Document ID:</label>
                        <input type="text" id="filter-doc" placeholder="e.g., Gos018" style="width: 150px;">
                    </div>

                    <div class="filter-group">
                        <label>Text search:</label>
                        <input type="text" id="filter-search" placeholder="Search in A or B text..." style="min-width: 250px;">
                    </div>
                </div>
            </div>

            <div class="filters-row">
                <button id="btn-reset" class="btn-secondary">üîÑ Reset All Filters</button>
                <button id="btn-export" class="btn-primary">üì• Export Filtered Results to CSV</button>
            </div>
        </div>

        <!-- Results count -->
        <div class="results-info">
            <span id="results-count">Loading...</span>
        </div>

        <!-- Candidates list -->
        <div id="candidates-list" class="candidates-list">
            <div class="loading">Loading candidates...</div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
